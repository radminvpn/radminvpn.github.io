$(function(){function l(){var e={selected_text:0,full_text:0,selection_start:-1,selection_end:-1};if("None"!=getSelection().type){for(e=window.getSelection(),selected_text=e.toString(),selected_text=selected_text.replace(/\s+/g," "),full_text=e.anchorNode.parentNode;selected_text.length>$(full_text).text().length;)full_text=full_text.parentNode;full_text=$(full_text).clone(),full_text.find("br").replaceWith(" "),full_text=full_text.text(),full_text=full_text.replace(/\s+/g," "),selection_start=full_text.indexOf(selected_text),selection_end=selection_start+selected_text.length}else{if(!document.selection)return e;for(e=document.selection.createRange(),selected_text=e.text,selected_text=selected_text.replace(/\s+/g," "),full_text=e.parentElement();selected_text.length>$(full_text).text().length;)full_text=full_text.parentElement();var t=e.duplicate();t.moveToElementText(full_text),t.setEndPoint("EndToEnd",e),selection_start=t.text.length-e.text.length,selection_end=selection_start+selected_text.length}return-1==selection_start?alert(se_message_1):e={selected_text:selected_text,full_text:full_text,selection_start:selection_start,selection_end:selection_end}}function r(e){return void 0!==e&&-1!=e.selection_start&&(selection_start=e.selection_start,selection_end=e.selection_end,context=e.full_text,context_first=context.substring(0,selection_start),context_second=context.substring(selection_start,selection_end),context_third=context.substring(selection_end,context.length),context=context_first+'<span class="red">'+context_second+"</span>"+context_third,context_start=selection_start-60,context_start<0&&(context_start=0),context_end=selection_end+60,context_end>context.length&&(context_end=context.length),context=context.substring(context_start,context_end),context)}function o(e){"#err-content"==e&&$(e).modal(),"#err-complete"==e&&$(e).modal()}$(document).ready(function(){var s=!1;$(document).keyup(function(e){17==e.which&&(s=!1)}).keydown(function(e){if(17==e.which&&(s=!0),13==e.which&&1==s){var t=l(),n=r(t);0<t.selected_text.length&&t.selected_text.length<=150?($("#err-text").html(n),$("#err-status").empty(),$("#err-mess").css({backgroundColor:"#ffffff"}),o("#err-content")):150<t.selected_text.length?alert(se_message_2):alert(se_message_1)}}),$("body").on("click","#err-button",function(){if(0<$("#err-mess").val().length)var e=!0;else{$("#err-status").html(se_message_5),$("#err-status").css({color:"#ff0000"}).show(),$("#err-mess").css({backgroundColor:"#ff8888"});e=!1;$.modal.resize()}e&&($("#loader").width($("#err-content").innerWidth()).height($("#err-content").innerHeight()).offset($("#err-content").offset()).show(),$.ajax({type:"POST",url:"/send_error.php",data:{text:$("#err-text").html(),message:$("#err-mess").val(),pageurl:window.location.href},success:function(e){$("#loader").hide().removeAttr("style"),$.modal.close(),"Success"==e?$("#err-complete").html(se_message_4):$("#err-complete").html(se_message_3+e),o("#err-complete"),setTimeout(function(){$.modal.close()},5e3)},error:function(){$("#loader").hide().removeAttr("style"),alert(se_message_3+"09")}}))}),$("#err-mess").keyup(function(){0<$("#err-mess").val().length&&0<$("#err-status").html().length||0==$("#err-status").html().length?($("#err-mess").css({backgroundColor:"#ffffff"}),$("#err-status").css({color:"#ff0000"}).hide()):($("#err-mess").css({backgroundColor:"#ff8888"}),$("#err-status").css({color:"#ff0000"}).show())})})});